# How to run a fullnode of BITWAY blockchain

## Setting up the keyring (Optional)

The keyring holds the private/public keypairs used to interact with a node. For instance, a validator key needs to be set up before running the blockchain node, so that blocks can be correctly signed. The private key can be stored in different locations, called "backends", such as a file or the operating system's own key storage.

> Available backends for the keyring
> 1. The os backend
> 2. The file backend
> 3. The pass backend
> 4. The kwallet backend
> 5. The test backend
> 6. The memory backend
> You can visit https://docs.cosmos.network/v0.47/run-node/keyring for more details

## Adding keys to the keyring
```sh
bitwayd keys add alice
Enter keyring passphrase (attempt 1/3):

- address: bitway1raru385lzypr5jw2al4dl9ls5900t02f99z7dw
  name: alice
  pubkey: '{"@type":"/cosmos.crypto.secp256k1.PubKey","key":"Ak43PcCCEr8J0ljTUN+xs0nJiLlwrqHVsii8uRNzX7M5"}'
  type: local

**Important** write this mnemonic phrase in a safe place.
It is the only way to recover your account if you ever forget your password.

enroll index bind glad tonight rhythm barely negative south quarter main length venue funny dance short loud foil electric thumb anger similar like nice
```

This command generates a new 24-word mnemonic phrase, persists it to the relevant backend, and outputs information about the keypair. If this keypair will be used to hold value-bearing tokens, be sure to write down the mnemonic phrase somewhere safe!

By default, the keyring generates a `secp256k1` keypair. The keyring also supports `ed25519` keys, which may be created by passing the `--algo ed25519` flag. A keyring can of course hold both types of keys simultaneously, and the Cosmos SDK's x/auth module supports natively these two public key algorithms.

### Query your local keys:
```sh
bitwayd keys list
```

## Initialize the BITWAY Node

Before actually running the node, we need to initialize the blockchain, and most importantly its genesis file. This is done with the init subcommand:

Use `bitwayd` to initialize your node:

```sh
bitwayd init <MY_VALIDATOR> --chain-id=bitway-1 --home ~/.bitway
```

The command above creates all the configuration files needed for your node to run, as well as a default genesis file, which defines the initial state of the network. All these configuration files are in `~/.bitway` by default, but you can overwrite the location of this folder by passing the `--home` flag.

The ~/.bitway folder has the following structure:

```shell
.                                   # ~/.bitway
  |- data                           # Contains the databases used by the node.
  |- config/
      |- app.toml                   # Application-related configuration file.
      |- config.toml                # CometBFT-related configuration file.
      |- genesis.json               # The genesis file.
      |- node_key.json              # Private key to use for node authentication in the p2p protocol.
      |- priv_validator_key.json    # Private key to use as a validator in the consensus protocol.
```

## Configuring the Node Using app.toml and config.toml

The Cosmos SDK automatically generates two configuration files inside `~/.bitway/config`:

 - `config.toml`: used to configure the CometBFT, learn more on CometBFT's documentation,
 - `app.toml`: generated by the Cosmos SDK, and used to configure your app, such as state pruning strategies, telemetry, gRPC and REST servers configuration, state sync...

Both files are heavily commented, please refer to them directly to tweak your node.

### Downloading the genesis file

Download the genesis file and replace your local one.

```sh
wget https://github.com/bitwaylabs/networks/mainnet/bitway-1/genesis.json -O $HOME/.bitway/config/genesis.json
````

### Adding seeds and persistent peers
Open the config.toml to edit the seeds and persistent peers:

```sh
cd $HOME/.bitway/config
nano config.toml
```

Modify the seed node or persistence node configuration by referring to the seeds and persistence details provided in the [endpoint.md](../endpoints.md) file

```toml
# seeds = "2eba9c8e6fb9d56bbdd10d007a598541c37f6493@13.212.61.41:26656"
seeds = ""
```

or 
```toml
# persistent_peers = "2eba9c8e6fb9d56bbdd10d007a598541c37f6493@13.212.61.41:26656"
persistent_peers = ""

```

### Setting up minimum gas prices

Open `app.toml`, find `minimum-gas-prices`, which defines the minimum gas prices the validator node is willing to accept for processing a transaction. Make sure to edit the field with some value, for example 0.0006ubtw. 

```toml
 # The minimum gas prices a validator is willing to accept for processing a
 # transaction. A transaction's fees must meet the minimum of any denomination
 # specified in this config (e.g. 0.25token1;0.0001token2).
 minimum-gas-prices = "0.0006ubtw,0.000001sat"
```
### Disabling the Oracle Module

To disable the oracle functionality, open your `app.toml` file and locate the `[oracle]` section. This section contains parameters required for nodes to query data from a Bitcoin client.

Set the following configuration:

```toml
[oracle]
# Set to true if this node will act as a validator. For non-validator (full) nodes, set to false.
enable = false

bitcoin_rpc = ""
bitcoin_rpc_user = ""
bitcoin_rpc_password = ""
http_post_mode = true
disable_tls = true
```

> **Note:**  
> Setting `enable = false` ensures that your node will not attempt to perform oracle duties or connect to a Bitcoin client. This is recommended for full nodes that do not participate in validation or oracle services.


# Start Node and Sync
```sh
bitwayd tendermint unsafe-reset-all 
bitwayd start
```
Check status:
```sh
bitwayd status
```
```sh
{
    "NodeInfo":{
        "protocol_version":{
            "p2p":"8",
            "block":"11",
            "app":"0"
        },
        "id":"2eba9c8e6fb9d56bbdd10d007a598541c37f6493",
        "listen_addr":"tcp://0.0.0.0:26656",
        "network":"bitway-1",
        "version":"0.37.1",
        "channels":"40202122233038606100",
        "moniker":"bitway",
        "other":{
            "tx_index":"on",
            "rpc_address":"tcp://0.0.0.0:26657"
        }
    },
    "SyncInfo":{
        "latest_block_hash":"B00CEEDD079C673847F99E1DE718109F2A114445DB0C5D5F52E4AAF314B9C8B7",
        "latest_app_hash":"9E86219F61A7CC188DD4CB00B03B453975E04A56076C055DF54B53ED243054F5",
        "latest_block_height":"2566387",
        "latest_block_time":"2024-01-18T07:24:33.17990802Z",
        "earliest_block_hash":"C88B44EF56ADFBAC04858F7016D0FD238D0ED90FC19336A2B45B164DAA521BF4",
        "earliest_app_hash":"E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855",
        "earliest_block_height":"1",
        "earliest_block_time":"2023-08-19T07:17:58.100481172Z",
        "catching_up":false
    },
    "ValidatorInfo":{
        "Address":"1DA4375220D4F8A578E6EA123E2B8CA995294DF4",
        "PubKey":{
            "type":"tendermint/PubKeyEd25519",
            "value":"FpGF3a/GimqEDxg4rQsX8CntMJxI2hwoDNLj4x2zZWQ="
        },
        "VotingPower":"1800000101422"
    }
}
```
